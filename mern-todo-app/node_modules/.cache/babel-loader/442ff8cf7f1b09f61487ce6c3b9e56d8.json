{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _redux = require('redux');\n\nvar _immutable = require('immutable');\n\nvar _immutable2 = _interopRequireDefault(_immutable);\n\nvar _reactRedux = require('react-redux');\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _lodash = require('lodash');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _dataReducer = require('./reducers/dataReducer');\n\nvar dataReducers = _interopRequireWildcard(_dataReducer);\n\nvar _components = require('./components');\n\nvar _components2 = _interopRequireDefault(_components);\n\nvar _settingsComponentObjects = require('./settingsComponentObjects');\n\nvar _settingsComponentObjects2 = _interopRequireDefault(_settingsComponentObjects);\n\nvar _dataSelectors = require('./selectors/dataSelectors');\n\nvar selectors = _interopRequireWildcard(_dataSelectors);\n\nvar _compositionUtils = require('./utils/compositionUtils');\n\nvar _columnUtils = require('./utils/columnUtils');\n\nvar _rowUtils = require('./utils/rowUtils');\n\nvar _actions = require('./actions');\n\nvar actions = _interopRequireWildcard(_actions);\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar defaultEvents = _extends({}, actions, {\n  onFilter: actions.setFilter,\n  setSortProperties: function setSortProperties(_ref) {\n    var setSortColumn = _ref.setSortColumn,\n        sortProperty = _ref.sortProperty,\n        columnId = _ref.columnId;\n    return function (event) {\n      if (sortProperty === null) {\n        setSortColumn({\n          id: columnId,\n          sortAscending: true\n        });\n        return;\n      }\n\n      var newSortProperty = _extends({}, sortProperty, {\n        sortAscending: !sortProperty.sortAscending\n      });\n\n      setSortColumn(newSortProperty);\n    };\n  }\n});\n\nvar defaultStyleConfig = {\n  icons: {\n    TableHeadingCell: {\n      sortDescendingIcon: '▼',\n      sortAscendingIcon: '▲'\n    }\n  },\n  classNames: {\n    Cell: 'griddle-cell',\n    Filter: 'griddle-filter',\n    Loading: 'griddle-loadingResults',\n    NextButton: 'griddle-next-button',\n    NoResults: 'griddle-noResults',\n    PageDropdown: 'griddle-page-select',\n    Pagination: 'griddle-pagination',\n    PreviousButton: 'griddle-previous-button',\n    Row: 'griddle-row',\n    RowDefinition: 'griddle-row-definition',\n    Settings: 'griddle-settings',\n    SettingsToggle: 'griddle-settings-toggle',\n    Table: 'griddle-table',\n    TableBody: 'griddle-table-body',\n    TableHeading: 'griddle-table-heading',\n    TableHeadingCell: 'griddle-table-heading-cell',\n    TableHeadingCellAscending: 'griddle-heading-ascending',\n    TableHeadingCellDescending: 'griddle-heading-descending'\n  },\n  styles: {}\n};\n\nvar Griddle = function (_Component) {\n  _inherits(Griddle, _Component);\n\n  function Griddle(props) {\n    _classCallCheck(this, Griddle);\n\n    var _this = _possibleConstructorReturn(this, (Griddle.__proto__ || Object.getPrototypeOf(Griddle)).call(this, props));\n\n    var _props$plugins = props.plugins,\n        plugins = _props$plugins === undefined ? [] : _props$plugins,\n        data = props.data,\n        rowPropertiesComponent = props.children,\n        _props$events = props.events,\n        events = _props$events === undefined ? {} : _props$events,\n        _props$sortProperties = props.sortProperties,\n        sortProperties = _props$sortProperties === undefined ? {} : _props$sortProperties,\n        _props$styleConfig = props.styleConfig,\n        styleConfig = _props$styleConfig === undefined ? {} : _props$styleConfig,\n        importedPageProperties = props.pageProperties,\n        userComponents = props.components,\n        _props$renderProperti = props.renderProperties,\n        userRenderProperties = _props$renderProperti === undefined ? {} : _props$renderProperti;\n    var rowProperties = (0, _rowUtils.getRowProperties)(rowPropertiesComponent);\n    var columnProperties = (0, _columnUtils.getColumnProperties)(rowPropertiesComponent); //Combine / compose the reducers to make a single, unified reducer\n\n    var reducers = (0, _compositionUtils.buildGriddleReducer)([dataReducers].concat(_toConsumableArray(plugins.map(function (p) {\n      return p.reducer;\n    })))); //Combine / Compose the components to make a single component for each component type\n\n    _this.components = (0, _compositionUtils.buildGriddleComponents)([_components2.default].concat(_toConsumableArray(plugins.map(function (p) {\n      return p.components;\n    })), [userComponents]));\n    _this.settingsComponentObjects = Object.assign.apply(Object, [{}, _settingsComponentObjects2.default].concat(_toConsumableArray(plugins.map(function (p) {\n      return plugins.settingsComponentObjects;\n    }))));\n    _this.events = Object.assign.apply(Object, [{}, events].concat(_toConsumableArray(plugins.map(function (p) {\n      return plugins.events;\n    }))));\n    _this.selectors = plugins.reduce(function (combined, plugin) {\n      return _extends({}, combined, plugin.selectors);\n    }, _extends({}, selectors));\n\n    var mergedStyleConfig = _lodash2.default.merge({}, defaultStyleConfig, styleConfig);\n\n    var pageProperties = Object.assign({}, {\n      currentPage: 1,\n      pageSize: 10\n    }, importedPageProperties); //TODO: This should also look at the default and plugin initial state objects\n\n    var renderProperties = Object.assign.apply(Object, [{\n      rowProperties: rowProperties,\n      columnProperties: columnProperties\n    }].concat(_toConsumableArray(plugins.map(function (p) {\n      return p.renderProperties;\n    })), [userRenderProperties])); // TODO: Make this its own method\n\n    var initialState = plugins.reduce(function (combined, plugin) {\n      return !!plugin.initialState ? _extends({}, combined, plugin.initialState) : combined;\n    }, {\n      renderProperties: renderProperties,\n      data: data,\n      enableSettings: true,\n      pageProperties: pageProperties,\n      sortProperties: sortProperties,\n      textProperties: {\n        settingsToggle: 'Settings'\n      },\n      styleConfig: mergedStyleConfig\n    });\n    _this.store = (0, _redux.createStore)(reducers, initialState);\n    return _this;\n  }\n\n  _createClass(Griddle, [{\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      var data = nextProps.data,\n          pageProperties = nextProps.pageProperties,\n          sortProperties = nextProps.sortProperties;\n      this.store.dispatch(actions.updateState({\n        data: data,\n        pageProperties: pageProperties,\n        sortProperties: sortProperties\n      }));\n    }\n  }, {\n    key: 'getChildContext',\n    value: function getChildContext() {\n      return {\n        components: this.components,\n        settingsComponentObjects: this.settingsComponentObjects,\n        events: this.events,\n        selectors: this.selectors\n      };\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      return _react2.default.createElement(_reactRedux.Provider, {\n        store: this.store\n      }, _react2.default.createElement(this.components.Layout, null));\n    }\n  }]);\n\n  return Griddle;\n}(_react.Component);\n\nGriddle.childContextTypes = {\n  components: _react2.default.PropTypes.object.isRequired,\n  settingsComponentObjects: _react2.default.PropTypes.object,\n  events: _react2.default.PropTypes.object,\n  selectors: _react2.default.PropTypes.object\n};\nexports.default = Griddle;","map":null,"metadata":{},"sourceType":"script"}